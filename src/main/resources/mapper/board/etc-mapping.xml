<?xml version="1.0" encoding="UTF-8" ?>
<!-- mapper DTD 선언 -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.springbook.etc.mapper.EtcMapper">

	<!--문의추가 -->
	<insert id="insertAsk" parameterType="com.springbook.etc.vo.JoinAskVO">
		INSERT INTO JOIN_ASK
		(
		company_nm, 
		ceo_nm, 
		business_num, 
		company_phone_num, 
		addr1, 
		addr2, 
		manager_nm,
		file_id,
		business_type,		
		reg_date
		)
		VALUES
		(
		#{companyNm}, 
		#{ceoNm}, 
		#{businessNum}, 
		#{companyPhoneNum},
		#{addr1}, 
		#{addr2}, 
		#{managerNm},
		#{fileId},
		#{businessType},
		now()		
		)
	</insert>

	<!--문의전체개수 -->
	<select id="inquiryListCount" resultType="int" parameterType="java.lang.String">
		SELECT 
		COUNT(*)
		FROM
		JOIN_ASK
		WHERE 
		DEL_YN = "N"
		<if test= "keyword != null and !keyword.equals('')">
    	AND	COMPANY_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
	</select>
	
	<!--키워드&페이징 포함 문의 -->
	<select id="getInquiryList" resultType="com.springbook.etc.vo.JoinAskVO" parameterType="Map">
		SELECT
		*
		FROM
		JOIN_ASK LEFT OUTER JOIN FILE ON JOIN_ASK.FILE_ID = FILE.FILE_ID
		WHERE 
		JOIN_ASK.DEL_YN = 'N'
		<if test= "keyword != null and !keyword.equals('')">
    	AND	JOIN_ASK.COMPANY_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
   		ORDER BY JOIN_ASK.REG_DATE DESC
		LIMIT #{i}, #{contentnum}
	</select>
	
	<!--신규가입문의 상세보기 -->
	<select id="getInquiryDetail" resultType="com.springbook.etc.vo.JoinAskVO" parameterType="java.lang.String">
		SELECT
		*
		FROM
		JOIN_ASK
		WHERE 
		DEL_YN = 'N'
    	AND	IDX = #{idx}
	</select>
	
	<!--신규가입문의 정보저장 -->
	<update id="updateInquiry" parameterType="Map">
		UPDATE
		JOIN_ASK
		SET INFO = #{info}
    	WHERE IDX = #{idx}
	</update>
	
	<!--제품명등록관리 전체 개수 -->
	<select id="productListCount" resultType="int" parameterType="Map">
		SELECT 
		COUNT(*)
		FROM
	    PRODUCT
		WHERE 
		DEL_YN = 'N'
		<if test= "keyword != null and keyword.equals('') and type.equals('product_nm')">
    	AND	PRODUCT_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
		<if test= "keyword != null and !keyword.equals('') and type.equals('type')">
    	AND	TYPE LIKE CONCAT("%",#{keyword},"%")
   		</if>   
	</select>
	
	<!--페이지&키워드 포함 제품명 등록관리조회 -->
	<select id="getProductList" resultType="com.springbook.etc.vo.ProductVO" parameterType="Map">
		SELECT
		*
		FROM
		PRODUCT
		WHERE 
		DEL_YN = 'N'
		<if test= "keyword != null and !keyword.equals('') and type.equals('productNm')">
    	AND	PRODUCT_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
		<if test= "keyword != null and !keyword.equals('') and type.equals('type')">
    	AND	TYPE LIKE CONCAT("%",#{keyword},"%")
   		</if> 
		LIMIT #{i}, #{contentnum}
	</select>
		
	<!--제품타입추가 -->
	<insert id="addProductType" parameterType="com.springbook.etc.vo.ProductVO">
		INSERT INTO PRODUCT
		(
		product_nm, 
		product_cd, 
		type, 
		file_id, 
		file_nm,
		reg_date
		)
		VALUES
		(
		#{productNm}, 
		#{productCd}, 
		#{type}, 
		#{fileId},
		#{fileNm},
		now()		
		)
	</insert>
	
		<!--제품타입추가 -->
	<update id="updateProductType" parameterType="com.springbook.etc.vo.ProductVO">
		UPDATE
		PRODUCT
		SET product_nm = #{productNm},
			product_cd = #{productCd},
			type = #{type},
			file_id = #{fileId},
			file_nm = #{fileNm},
			reg_date = now()
    	WHERE PRODUCT_IDX = #{productIdx}
	</update>
	
	<!--제품타입삭제 -->
	<delete id="typeDelete" parameterType="java.lang.String">
	    DELETE FROM PRODUCT
	    WHERE
        PRODUCT_IDX = ${list}
	</delete>

	<!--두께등록관리 전체 개수 -->
	<select id="thicknessListCount" resultType="int" parameterType="Map">
		SELECT 
		COUNT(*)
		FROM
		PRODUCT_THICKNESS A
		INNER JOIN PRODUCT B ON B.PRODUCT_CD = A.PRODUCT_CD
		WHERE 
		B.DEL_YN = 'N'
		<if test= "keyword != null and keyword.equals('') and type.equals('productNm')">
    	AND	B.PRODUCT_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
		<if test= "keyword != null and !keyword.equals('') and type.equals('thickness')">
    	AND	A.THICKNESS LIKE CONCAT("%",#{keyword},"%")
   		</if>   
	</select>
	
	<!--페이지&키워드 포함 두께 등록관리조회 -->
	<select id="getThicknessList" resultType="Map" parameterType="Map">
		SELECT
		A.*, B.PRODUCT_NM,C.ORIG_NM AS FILE_NM
		FROM
		PRODUCT_THICKNESS A
		INNER JOIN PRODUCT B ON B.PRODUCT_CD = A.PRODUCT_CD
		LEFT OUTER JOIN FILE C ON C.FILE_ID = A.FILE_ID
		WHERE 
		B.DEL_YN = 'N'
		<if test= "keyword != null and !keyword.equals('') and type.equals('productNm')">
    	AND	B.PRODUCT_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
		<if test= "keyword != null and !keyword.equals('') and type.equals('thickness')">
    	AND	A.THICKNESS LIKE CONCAT("%",#{keyword},"%")
   		</if> 
		LIMIT #{i}, #{contentnum}
	</select>
	
	<!--제품명등록관리 전체 개수 -->
	<select id="getProductNameList" resultType="com.springbook.etc.vo.ProductVO">
		SELECT 
		*
		FROM
	    PRODUCT
		WHERE 
		DEL_YN = 'N'
	</select>
	
	<!--제품두께추가 -->
	<insert id="addProductThickness" parameterType="com.springbook.etc.vo.ProductVO">
		INSERT INTO PRODUCT_THICKNESS
		(
		product_cd, 
		thickness, 
		test_institute,
		test_num, 
		file_id,
		custom_order,
		reg_date
		)
		VALUES
		(
		#{productCd}, 
		#{thickness},
		#{testInstitute}, 
		#{testNum}, 
		#{fileId},
		#{customOrder},
		now()		
		)
	</insert>

	<!--제품두께업데이트 -->
	<update id="updateProductThickness" parameterType="com.springbook.etc.vo.ProductVO">
		UPDATE
		PRODUCT_THICKNESS
		SET product_Cd = #{productCd},
			thickness = #{thickness},
			test_institute = #{testInstitute},
			test_num = #{testNum},
			file_id = #{fileId},
			custom_order = #{customOrder},
			reg_date = now()
    	WHERE THICKNESS_IDX = #{thicknessIdx}		
	</update>
		
	<!--제품두께삭제 -->
	<delete id="thicknessDelete" parameterType="java.lang.String">
	    DELETE FROM PRODUCT_THICKNESS
	    WHERE
        PRODUCT_IDX = ${list}
	</delete>
	
	<!--사이즈등록관리 전체 개수 -->
	<select id="sizeListCount" resultType="int" parameterType="Map">
		SELECT 
		COUNT(*)
		FROM
		PRODUCT_SIZE A INNER JOIN PRODUCT_THICKNESS B ON A.PRODUCT_CD = B.PRODUCT_CD
		INNER JOIN PRODUCT C ON A.PRODUCT_CD = C.PRODUCT_CD
		WHERE 
		C.DEL_YN = 'N'
		<if test= "keyword != null and keyword.equals('') and type.equals('productNm')">
    	AND	C.PRODUCT_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
		<if test= "keyword != null and !keyword.equals('') and type.equals('size')">
    	AND	A.SIZE LIKE CONCAT("%",#{keyword},"%")
   		</if>   
	</select>
	
	<!--페이지&키워드 포함 사이즈 등록관리조회 -->
	<select id="getSizeList" resultType="Map" parameterType="Map">
		SELECT
		A.*, B.THICKNESS AS THICKNESS, C.PRODUCT_NM AS PRODUCT_NM
		FROM
		PRODUCT_SIZE A INNER JOIN PRODUCT_THICKNESS B ON A.PRODUCT_CD = B.PRODUCT_CD
		INNER JOIN PRODUCT C ON A.PRODUCT_CD = C.PRODUCT_CD
		WHERE 
		C.DEL_YN = 'N'
		<if test= "keyword != null and !keyword.equals('') and type.equals('productNm')">
    	AND	C.PRODUCT_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
		<if test= "keyword != null and !keyword.equals('') and type.equals('size')">
    	AND	A.SIZE LIKE CONCAT("%",#{keyword},"%")
   		</if> 
		LIMIT #{i}, #{contentnum}
	</select>
			
	<!--제품사이즈추가 -->
	<insert id="addProductSize" parameterType="com.springbook.etc.vo.ProductSizeVO">
		INSERT INTO PRODUCT_SIZE
		(
		product_cd, 
		size, 
		height,
		width,
		custom_order,
		reg_date
		)
		VALUES
		(
		#{productCd}, 
		#{size},
		#{height}, 
		#{width},
		#{customOrder},
		now()		
		)
	</insert>

	<!--제품두께업데이트 -->
	<update id="updateProductSize" parameterType="com.springbook.etc.vo.ProductSizeVO">
		UPDATE
		PRODUCT_SIZE
		SET product_Cd = #{productCd},
			size = #{size},
			height = #{height},
			width = #{width},
			custom_order = #{customOrder},
			reg_date = now()
    	WHERE SIZE_IDX = #{sizeIdx}		
	</update>
	
	<!--제품사이즈삭제 -->
	<delete id="sizeDelete" parameterType="java.lang.String">
	    DELETE FROM PRODUCT_SIZE
	    WHERE
        SIZE_IDX = ${list}
	</delete>
	
	<!--상세관리 전체 개수 -->
	<select id="detailListCount" resultType="int" parameterType="Map">
		SELECT
		COUNT(*)
		FROM
		PRODUCT_DETAIL DETAIL
			INNER JOIN PRODUCT_THICKNESS THICKNESS ON DETAIL.THICKNESS = THICKNESS.THICKNESS_IDX
			INNER JOIN PRODUCT PRODUCT ON PRODUCT.PRODUCT_CD = DETAIL.PRODUCT_CD
			INNER JOIN PRODUCT_SIZE SIZE ON SIZE.SIZE_IDX = DETAIL.SIZE
		WHERE 
		PRODUCT.DEL_YN = 'N'
		<if test= "keyword != null and !keyword.equals('') and type.equals('productNm')">
    	AND	PRODUCT.PRODUCT_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
		<if test= "keyword != null and !keyword.equals('') and type.equals('size')">
    	AND	SIZE.SIZE LIKE CONCAT("%",#{keyword},"%")
   		</if> 
   		<if test= "keyword != null and !keyword.equals('') and type.equals('thickness')">
    	AND	THICKNESS.THICKNESS LIKE CONCAT("%",#{keyword},"%")
   		</if>   
	</select>
	
	<!--페이지&키워드 포함 상세 등록관리조회 -->
	<select id="getDetailList" resultType="Map" parameterType="Map">
		SELECT
		DETAIL.*, SIZE.HEIGHT, SIZE.WIDTH ,THICKNESS.THICKNESS, PRODUCT.PRODUCT_NM
		FROM
		PRODUCT_DETAIL DETAIL
			INNER JOIN PRODUCT_THICKNESS THICKNESS ON DETAIL.THICKNESS = THICKNESS.THICKNESS_IDX
			INNER JOIN PRODUCT PRODUCT ON PRODUCT.PRODUCT_CD = DETAIL.PRODUCT_CD
			INNER JOIN PRODUCT_SIZE SIZE ON SIZE.SIZE_IDX = DETAIL.SIZE
		WHERE 
		PRODUCT.DEL_YN = 'N'
		<if test= "keyword != null and !keyword.equals('') and type.equals('productNm')">
    	AND	PRODUCT.PRODUCT_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
		<if test= "keyword != null and !keyword.equals('') and type.equals('size')">
    	AND	SIZE.SIZE LIKE CONCAT("%",#{keyword},"%")
   		</if> 
   		<if test= "keyword != null and !keyword.equals('') and type.equals('thickness')">
    	AND	THICKNESS.THICKNESS LIKE CONCAT("%",#{keyword},"%")
   		</if> 
		LIMIT #{i}, #{contentnum}
	</select>		
	
	<!--제품명에 따른 제품두께 조회 -->
	<select id="selectDetailThickness" resultType="Map" parameterType="java.lang.String">
		SELECT
		*
		FROM
		PRODUCT A LEFT OUTER JOIN PRODUCT_THICKNESS THICKNESS ON A.PRODUCT_CD = THICKNESS.PRODUCT_CD
		WHERE 
		A.DEL_YN = 'N' AND A.PRODUCT_CD = #{name}
		GROUP BY THICKNESS.THICKNESS
	</select>
	
	<!--제품명에 따른 제품사이즈 조회 -->
	<select id="selectDetailSize" resultType="Map" parameterType="java.lang.String">
		SELECT
		*
		FROM
		PRODUCT A LEFT OUTER JOIN PRODUCT_SIZE SIZE ON A.PRODUCT_CD = SIZE.PRODUCT_CD
		WHERE 
		A.DEL_YN = 'N' AND A.PRODUCT_CD = #{name}
		GROUP BY SIZE.SIZE
	</select>
	
	<!--제품 상세설정추가 -->
	<insert id="addProductDetail" parameterType="com.springbook.etc.vo.ProductDetailVO">
		INSERT INTO PRODUCT_DETAIL
		(
		product_cd,
		thickness,
		size,
		safety,
		pallet,
		slice,
		reg_date
		)
		VALUES
		(
		#{productCd}, 
		#{thickness},
		#{size},
		#{safety},
		#{pallet},
		#{slice},
		now()		
		)
	</insert>

	<!--제품 상세설정 수정 -->
	<update id="updateProductDetail" parameterType="com.springbook.etc.vo.ProductDetailVO">
		UPDATE
		PRODUCT_DETAIL
		SET product_cd = #{productCd},
			thickness = #{thickness},
			size = #{size},
			safety = #{safety},
			pallet = #{pallet},
			slice = #{slice},
			reg_date = now()
    	WHERE DETAIL_IDX = #{detailIdx}			
	</update>
	
	<!--상세설정 삭제 -->
	<delete id="detailDelete" parameterType="java.lang.String">
	    DELETE FROM PRODUCT_DETAIL
	    WHERE
        DETAIL_IDX = ${list}
	</delete>

	<!--신규가입 새로운 문의 체크 -->
	<update id="checkNew" parameterType="java.lang.String">
		UPDATE
		JOIN_ASK
		SET CHECK_NEW = "1"
    	WHERE IDX = #{idx}
	</update>
			
	<!--창고 전체 개수 -->
	<select id="warehouseListCount" resultType="int">
		SELECT 
		COUNT(*)
		FROM
	    WAREHOUSE
		WHERE 
		DEL_YN = 'N'
	</select>
	
	<!--페이지 포함 창고조회 -->
	<select id="getWarehouseList" resultType="com.springbook.etc.vo.WarehouseVO" parameterType="Map">
		SELECT
		*
		FROM
		WAREHOUSE
		WHERE DEL_YN = "N"
		LIMIT #{i}, #{contentnum}
	</select>
	
	<!--창고 재고 반영 넣기 -->
	<insert id="insertInventoryStock">
	    INSERT INTO WAREHOUSE_STOCK
		(
		warehouse,
		product_cd,
		product_nm,
		thickness,
		size, 
		stock,
		reason,
		reg_date
		)
		VALUES
		(
		#{warehouse}, 
		#{productCd}, 
		#{productNm}, 
		#{thickness},
		#{size},
		#{stock}, 
		#{reason},
		now()		
		)
	</insert>
	
	<!--창고 재고 반영 넣기 -->
	<update id="updateInventoryStock">
		UPDATE
		WAREHOUSE_STOCK
		SET STOCK = #{stock} , REASON = #{reason}, REG_DATE = now()
    	WHERE
		THICKNESS = #{thickness} AND
		SIZE = #{size} AND
		PRODUCT_CD = #{productCd} AND
		WAREHOUSE = #{warehouse} AND
		PRODUCT_NM = #{productNm}
	</update>
	
	<!--페이지 포함 창고조회 -->
	<select id="inventoryStockInfo" parameterType="Map" resultType="com.springbook.etc.vo.WarehouseStockVO">
		SELECT
		*
		FROM
		WAREHOUSE_STOCK
		WHERE
		THICKNESS = #{thickness} AND
		SIZE = #{size} AND
		PRODUCT_CD = #{productCd} AND
		WAREHOUSE = #{warehouse}
	</select>
	
	<!--창고 재고변경목록 넣기 -->
	<insert id="insertInventoryInfo">
	    INSERT INTO WAREHOUSE_inventory
		(
		warehouse_idx,
		product_cd,
		thickness,
		size, 
		stock,
		reason,
		reg_date
		)
		VALUES
		(
		#{warehouseIdx}, 
		#{productCd},		
		#{thickness},
		#{size},
		#{stock}, 
		#{reason},
		now()		
		)
	</insert>
	
	<!--단일 제품명-->
	<select id="getProductInfo" parameterType="java.lang.String" resultType="com.springbook.etc.vo.ProductVO">
		SELECT
		*
		FROM
		PRODUCT
		WHERE
		PRODUCT_IDX = #{idx}
	</select>
	
	<!--단일 두께정보조회-->
	<select id="getThicknessInfo" parameterType="java.lang.String" resultType="Map">
		SELECT
		A.*,B.PRODUCT_NM
		FROM
		PRODUCT_THICKNESS AS A
		INNER JOIN PRODUCT AS B ON A.PRODUCT_CD =B.PRODUCT_CD
		WHERE
		A.THICKNESS_IDX = #{idx}
	</select>

	<!--단일 사이즈정보조회-->
	<select id="getSizeInfo" parameterType="java.lang.String" resultType="Map">
		SELECT
		A.*,B.PRODUCT_NM
		FROM
		PRODUCT_SIZE AS A
		INNER JOIN PRODUCT AS B ON A.PRODUCT_CD =B.PRODUCT_CD
		WHERE
		A.SIZE_IDX = #{idx}
	</select>
		
	<!--단일 상세설정조회-->
	<select id="getDetailInfo" parameterType="java.lang.String" resultType="map">
		SELECT
		DETAIL.*, SIZE.HEIGHT, SIZE.WIDTH
		FROM
		PRODUCT_DETAIL DETAIL
			INNER JOIN PRODUCT_THICKNESS THICKNESS ON DETAIL.THICKNESS = THICKNESS.THICKNESS_IDX
			INNER JOIN PRODUCT PRODUCT ON PRODUCT.PRODUCT_CD = DETAIL.PRODUCT_CD
			INNER JOIN PRODUCT_SIZE SIZE ON SIZE.SIZE_IDX = DETAIL.SIZE
		WHERE
		DETAIL_IDX = #{idx}
	</select>
	
	<!--제품별상세설정 검색 개수 -->
	<select id="safetyListCount" resultType="int" parameterType="java.lang.String">
		SELECT 
		COUNT(*)
		FROM
		PRODUCT_DETAIL
		WHERE 
		DEL_YN = "N"
		<if test= "keyword != null and !keyword.equals('')">
    	AND	PRODUCT_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
	</select>
	
	<!--제품별상세 포함 검색 페이징포함 -->
	<select id="getSafetyList" resultType="Map" parameterType="Map">
		SELECT
		*
		FROM
		PRODUCT_DETAIL DETAIL
		INNER JOIN PRODUCT A ON A.PRODUCT_NM = DETAIL.PRODUCT_NM 
		WHERE 
		A.DEL_YN = 'N'
		<if test= "keyword != null and !keyword.equals('')">
    	AND	PRODUCT_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
		LIMIT #{i}, #{contentnum}
	</select>
	
	<!--여신관리 개수조회-->
	<select id="creditListCount" resultType="int" parameterType="Map">
		SELECT 
		COUNT(*)
		FROM
		DEPOSIT_HISTORY
		<if test= "keyword != null and !keyword.equals('')">
    	WHERE COMPANY_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
   		<if test= "keyword != null and !keyword.equals('') and !keyword.equals('') and startDt != null and !startDt.equals('') and endDt != null and !endDt.equals('')">
    	AND DATE(DEP_DATE) BETWEEN #{startDt} AND #{endDt}
   		</if>
   		<if test= "keyword != null and keyword.equals('') and startDt != null and endDt != null">
    	WHERE DATE(DEP_DATE) BETWEEN #{startDt} AND #{endDt}
   		</if>
	</select>
	
	<!--여신관리 페이징포함 조회 -->
	<select id="getCreditList" resultType="Map" parameterType="Map">
		SELECT
		*
		FROM
		DEPOSIT_HISTORY HISTORY
		INNER JOIN MEMBER MEMBER ON MEMBER.COMPANY_NM = HISTORY.COMPANY_NM
		<if test= "keyword != null and !keyword.equals('')">
    	WHERE HISTORY.COMPANY_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
   		<if test= "keyword != null and !keyword.equals('') and startDt != null and !startDt.equals('') and endDt != null and !endDt.equals('')">
    	AND DATE(DEP_DATE) BETWEEN #{startDt} AND #{endDt}
   		</if>
   		<if test= "keyword != null and keyword.equals('') and startDt != null and endDt != null">
    	WHERE DATE(DEP_DATE) BETWEEN #{startDt} AND #{endDt}
   		</if>
   		GROUP BY HISTORY.IDX
		LIMIT #{i}, #{contentnum}
	</select>
	
	<!--입금등록 거래처 검색 -->
	<select id="memberList" resultType="com.springbook.member.vo.MemberVO">
		SELECT
		*
		FROM
		MEMBER
		WHERE 
		DEL_YN = 'N' AND ROLE = '1'
	</select>
	
	<!--창고별재고관리 전체 개수 -->
	<select id="inventoryHistoryAllCount" resultType="int">
		SELECT
		COUNT(*)
		FROM
		WAREHOUSE_INVENTORY A
		INNER JOIN PRODUCT_THICKNESS B ON A.THICKNESS = B.THICKNESS_IDX
		INNER JOIN PRODUCT C ON C.PRODUCT_CD = A.PRODUCT_CD
		INNER JOIN PRODUCT_SIZE D ON D.SIZE_IDX = A.SIZE
		INNER JOIN WAREHOUSE E ON E.WAREHOUSE_IDX = A.WAREHOUSE_IDX
	</select>

	<!--창고별재관리 조건별 개수 -->
	<select id="inventoryHistoryCount" resultType="int" parameterType="Map">
		SELECT
		COUNT(*)
		FROM
		WAREHOUSE_INVENTORY A
		INNER JOIN PRODUCT_THICKNESS B ON A.THICKNESS = B.THICKNESS_IDX
		INNER JOIN PRODUCT C ON C.PRODUCT_CD = A.PRODUCT_CD
		INNER JOIN PRODUCT_SIZE D ON D.SIZE_IDX = A.SIZE
		INNER JOIN WAREHOUSE E ON E.WAREHOUSE_IDX = A.WAREHOUSE_IDX
		<if test= " !'null0'.equals(productCd) or !'null0'.equals(warehouseIdx)">
		WHERE
		</if>
		<if test= "!'null0'.equals(productCd)">
		C.PRODUCT_CD = #{productCd}
		</if>
		<if test= "'null0'.equals(productCd) and !'null0'.equals(warehouseIdx)">
		E.WAREHOUSE_IDX = #{warehouseIdx}
		</if>
		<if test= " !'null0'.equals(productCd) and !'null0'.equals(warehouseIdx)">
		AND E.WAREHOUSE_IDX = #{warehouseIdx}
		</if>
		<if test= "!'null0'.equals(size)">
		AND  D.SIZE_IDX = #{size}
		</if>
		<if test= "!'null0'.equals(thickness)">
		AND  B.THICKNESS_IDX = #{thickness}
		</if>				
	</select>
		
	<!--창고별재고관리 전체 목록 -->
	<select id="getInventoryHistory" resultType="Map">
		SELECT
		A.REG_DATE, A.REASON, A.STOCK, A.PRODUCT_CD,B.THICKNESS,C.PRODUCT_NM,D.HEIGHT,D.WIDTH,D.SIZE,E.WAREHOUSE
		FROM
		WAREHOUSE_INVENTORY A
		INNER JOIN PRODUCT_THICKNESS B ON A.THICKNESS = B.THICKNESS_IDX
		INNER JOIN PRODUCT C ON C.PRODUCT_CD = A.PRODUCT_CD
		INNER JOIN PRODUCT_SIZE D ON D.SIZE_IDX = A.SIZE
		INNER JOIN WAREHOUSE E ON E.WAREHOUSE_IDX = A.WAREHOUSE_IDX
		<if test= " !'null0'.equals(productCd) or !'null0'.equals(warehouseIdx)">
		WHERE
		</if>
		<if test= "!'null0'.equals(productCd)">
		C.PRODUCT_CD = #{productCd}
		</if>
		<if test= "'null0'.equals(productCd) and !'null0'.equals(warehouseIdx)">
		E.WAREHOUSE_IDX = #{warehouseIdx}
		</if>
		<if test= " !'null0'.equals(productCd) and !'null0'.equals(warehouseIdx)">
		AND E.WAREHOUSE_IDX = #{warehouseIdx}
		</if>
		<if test= "!'null0'.equals(size)">
		AND  D.SIZE_IDX = #{size}
		</if>
		<if test= "!'null0'.equals(thickness)">
		AND  B.THICKNESS_IDX = #{thickness}
		</if>							    	  	
		ORDER BY A.REG_DATE DESC
		LIMIT #{i}, #{contentnum}
	</select>

	<!--창고별재고현황 조건별 개수 -->
	<select id="inventoryStatusCount" resultType="int" parameterType="Map">
		SELECT COUNT(*)
		FROM
		(SELECT
		COUNT(*)
		FROM
		WAREHOUSE_INVENTORY A
		INNER JOIN PRODUCT_THICKNESS B ON A.THICKNESS = B.THICKNESS_IDX
		INNER JOIN PRODUCT C ON C.PRODUCT_CD = A.PRODUCT_CD
		INNER JOIN PRODUCT_SIZE D ON D.SIZE_IDX = A.SIZE
		INNER JOIN WAREHOUSE E ON E.WAREHOUSE_IDX = A.WAREHOUSE_IDX
		WHERE
		C.PRODUCT_CD = #{productCd} AND
		E.WAREHOUSE_IDX = #{warehouseIdx}
		GROUP BY E.WAREHOUSE_IDX, C.PRODUCT_CD,B.THICKNESS_IDX, D.SIZE_IDX
		) AS RESULT
		
	</select>
		
	<!--창고별재고현황 전체 목록 -->
	<select id="getInventoryStatus" resultType="Map">
		SELECT
		A.REG_DATE, A.REASON, SUM(A.STOCK) AS TOTAL_STOCK, A.PRODUCT_CD,B.THICKNESS,C.PRODUCT_NM,D.HEIGHT,D.WIDTH,
		D.SIZE,E.WAREHOUSE,E.WAREHOUSE_IDX, C.PRODUCT_CD,F.SAFETY, F.PALLET
		FROM
		WAREHOUSE_INVENTORY A
		INNER JOIN PRODUCT_THICKNESS B ON A.THICKNESS = B.THICKNESS_IDX
		INNER JOIN PRODUCT C ON C.PRODUCT_CD = A.PRODUCT_CD
		INNER JOIN PRODUCT_SIZE D ON D.SIZE_IDX = A.SIZE
		INNER JOIN WAREHOUSE E ON E.WAREHOUSE_IDX = A.WAREHOUSE_IDX
		INNER JOIN PRODUCT_DETAIL F ON F.PRODUCT_CD = A.PRODUCT_CD
		WHERE
		C.PRODUCT_CD = #{productCd} AND
		E.WAREHOUSE_IDX = #{warehouseIdx}
		GROUP BY E.WAREHOUSE_IDX, C.PRODUCT_CD,B.THICKNESS_IDX, D.SIZE_IDX
		LIMIT #{i}, #{contentnum}
	</select>
	
	<!--창고별재고 조건없을때목록 -->
	<select id="getInventoryHistoryAll" resultType="Map">
		SELECT
		A.REG_DATE, A.REASON, A.STOCK, A.PRODUCT_CD,B.THICKNESS,C.PRODUCT_NM,D.HEIGHT,D.WIDTH,D.SIZE,E.WAREHOUSE
		FROM
		WAREHOUSE_INVENTORY A
		INNER JOIN PRODUCT_THICKNESS B ON A.THICKNESS = B.THICKNESS_IDX
		INNER JOIN PRODUCT C ON C.PRODUCT_CD = A.PRODUCT_CD
		INNER JOIN PRODUCT_SIZE D ON D.SIZE_IDX = A.SIZE
		INNER JOIN WAREHOUSE E ON E.WAREHOUSE_IDX = A.WAREHOUSE_IDX
		ORDER BY A.REG_DATE DESC
		LIMIT #{i}, #{contentnum}
	</select>	
	
	<!--거래처검색 개수-->
	<select id="selectCompanyCount" resultType="int" parameterType="java.lang.String">
		SELECT 
		COUNT(*)
		FROM
		MEMBER
		WHERE ROLE = '1' 
		<if test= "keyword != null and !keyword.equals('')">
    	AND COMPANY_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
	</select>
	
	<!--거래처 검색 결과-->
	<select id="getSelectCompany" resultType="com.springbook.member.vo.MemberVO" parameterType="Map">
		SELECT
		*
		FROM
		MEMBER
		WHERE ROLE = '1' 
		<if test= "keyword != null and !keyword.equals('')">
    	AND COMPANY_NM LIKE CONCAT("%",#{keyword},"%")
   		</if>
   		LIMIT #{i}, #{contentnum}
	</select>

	<!--회사 재정정보 검색 결과-->
	<select id="searchCreditInfo" resultType="Map" parameterType="java.lang.String">
		SELECT
		*
		FROM
		CLIENT_MONEY_INFO MONEY
		INNER JOIN MEMBER MEMBER ON MEMBER.COMPANY_NM = MONEY.COMPANY_NM
		WHERE MONEY.COMPANY_NM = #{keyword}
		GROUP BY MONEY.IDX
	</select>
	
	<!--여신목록등록 -->
	<insert id="addDepositHistory">
	    INSERT INTO DEPOSIT_HISTORY
		(
		company_nm,
		total_dep,
		total_order,
		dep_date, 
		credit_amount,
		dep_amount,
		reg_date
		)
		VALUES
		(
		#{companyNm}, 
		#{totalDeposit}, 
		#{totalOrder}, 		
		#{depDate},
		#{credit},
		#{depAmount},
		now()		
		)
	</insert>
	
	<!--입금액 업로드 -->
	<update id="updateTotalDeposit">
		UPDATE
		CLIENT_MONEY_INFO
		SET TOTAL_DEPOSIT = #{updateDepositInfo}
    	WHERE
		COMPANY_NM = #{companyNm}
	</update>
	
	<!--여신관리삭제 -->
	<delete id="historyDelete" parameterType="java.lang.String">
	    DELETE FROM DEPOSIT_HISTORY
	    WHERE
        IDX = ${list}
	</delete>
	
	<!--여신관리 수정페이지 들어가기 -->
	<select id="searchDepositInfo" resultType="map" parameterType="java.lang.String">
		SELECT 
		HISTORY.*, MEMBER.CREDIT_AMOUNT
		FROM
		DEPOSIT_HISTORY HISTORY
		INNER JOIN MEMBER MEMBER ON MEMBER.COMPANY_NM = HISTORY.COMPANY_NM
		WHERE 
		IDX = #{idx}
	</select>
	
	<!--입금액 업로드 -->
	<update id="updateDepositHistory">
		UPDATE
		DEPOSIT_HISTORY
		SET DEP_DATE = #{depDate} ,TOTAL_DEP = #{totalDeposit}, DEP_AMOUNT = #{depAmount} WHERE IDX = #{idx}
	</update>
	
</mapper>